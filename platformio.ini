[platformio]
default_envs = esp32dev

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

# Partition configuration - UPDATED for larger factory
board_build.partitions = partitions.csv
board_build.filesystem = spiffs

# Serial settings
monitor_speed = 115200
upload_speed = 921600
monitor_filters = 
  esp32_exception_decoder
  colorize

# Build flags with size optimization
build_flags = 
  -D BOOTSEL_AP_SSID=\"BootSelector\"
  -D BOOTSEL_AP_PASS=\"12345678\"
  -Os                           ; Optimize for size
  -ffunction-sections           ; Remove unused functions
  -fdata-sections
  -Wl,--gc-sections
  -D CONFIG_ARDUHAL_LOG_COLORS=0  ; Disable colored logs
  -D CORE_DEBUG_LEVEL=0         ; Disable debug logs

# Use lightweight library
lib_deps = 
  mathieucarbou/ESPAsyncWebServer @ ^3.3.15

# Explicitly ignore conflicting libraries
lib_ignore = 
  AsyncTCP_RP2040W
  ESPAsyncTCP-esphome
